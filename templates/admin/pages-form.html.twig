{% extends 'base.html.twig' %}
{% block title %}
	{{titre}}
{% endblock %}
{% block body %}

	{% block macros %}
		{% macro niceForm(form) %}
			<div class="section-page">
				<div class="entete-section">
					<p class="sectionNum"></p>
				</div>
				{{form_row(form.titre)}}

				{# Ckeditor5 #}
				{{form_row(form.contenu)}}
				<div class="wrapper-ckeditor">
					<div id="editor[]" class="ckeditor"></div>
				</div>
				{# Fin Ckeditor5 #}

				<div class="boutons-galerie">
					{{form_row(form.galerie)}}
					<a href="{{path('galeries_creer_galerie')}}" class="btn">
						<i class="fa-solid fa-square-plus"></i>Créer galerie</a>
					<a href="" class="btn btn-ouvrir-galerie">
						<i class="fa-regular fa-folder-open"></i>Voir galerie</a>
				</div>
				<div class="container-miniatures"></div>
				<div class="pied-section">
					<button type="button" class="btn btnRemoveItem">
						<i class="fa-solid fa-trash-can"></i>Supprimer la section</button>
				</div>
			</div>
		{% endmacro niceForm %}
	{% endblock %}
	{% import _self as formMacros %}

	<h1 class="titre">{{titre}}</h1>
	{{ form_start(form) }}
	<div class="speed-dial">
		<div class="speed-dial__options">

			<div class="speed-dial-button">
				<button class="btn-enregistrer" type="submit">
					<i class="fa-solid fa-download"></i>
				</button>
				<span class="button-label">Enregistrer</span>
			</div>

			<div class="speed-dial-button">
				<button type="button" class="btnAddItem btn-creer-section" data-collection-holder-class="sectionsPages">
					<i class="fa-solid fa-plus"></i>
				</button>
				<span class="button-label">Créer section</span>
			</div>

			<div class="speed-dial-button btn-previsualiser-page">
				<a href="{{path('pages_previsualiser_page')}}" class="speed-dial__link">
					<i class="fa-regular fa-eye"></i>
				</a>
				<span class="button-label">Prévisualiser page</span>
			</div>
			<div class="speed-dial-button btn-revenir-liste-pages">
				<a href="{{path('pages_liste_pages')}}" class="speed-dial__link">
					<i class="fa-solid fa-file-lines"></i>
				</a>
				<span class="button-label">Revenir à la liste de pages</span>
			</div>
		</div>
	</div>
	{{ form_row(form.id) }}
	<div class="barre-horizontale-options-page">
		{{form_row(form.etat)}}
		{{ form_row(form.isPageAccueil)}}
		{{form_row(form.ordre)}}

	</div>
	{{form_row(form.titre)}}
	{{form_row(form.sous_titre)}}
	{{form_row(form.slug)}}
	{# {{form_row(form.icone_onglet)}} #}

	{# Sections de la page #}
		{% if (form.sectionsPages|length >0) %}
			<h3>
		Liste des sections de page :
	</h3>
	{% endif %}
		<div class="sectionsPages" data-index="{{ form.sectionsPages|length > 0 ? form.sectionsPages|last.vars.name + 1 : 0 }}" data-prototype="{{formMacros.niceForm(form.sectionsPages.vars.prototype)|e('html_attr') }}"> {% for section in form.sectionsPages %}
			{{formMacros.niceForm(section)}}
		{% endfor %}
	</div>
	{{ form_end(form) }}

	{% block javascripts %}
		<script type="module" src="{{asset('assets/js/sections-pages.js')}}" defer></script>
		<script type="module" src="{{asset('assets/js/pages.js')}}" defer></script>
		<script type="module" src="{{asset('ckeditor5/ckeditor5.js')}}" defer></script>
		<script type="module" src="{{asset('assets/js/ckeditor5init.js')}}"></script>
	{% endblock %}
{% endblock %}
